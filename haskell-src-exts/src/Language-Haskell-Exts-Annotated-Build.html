<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>src/Language/Haskell/Exts/Annotated/Build.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a><span class='hs-comment'>-----------------------------------------------------------------------------</span>
<a name="line-2"></a><span class='hs-comment'>-- |</span>
<a name="line-3"></a><span class='hs-comment'>-- Module      :  Language.Haskell.Exts.Annotated.Build</span>
<a name="line-4"></a><span class='hs-comment'>-- Copyright   :  (c) The GHC Team, 1997-2000,</span>
<a name="line-5"></a><span class='hs-comment'>--                (c) Niklas Broberg 2004</span>
<a name="line-6"></a><span class='hs-comment'>-- License     :  BSD-style (see the file LICENSE.txt)</span>
<a name="line-7"></a><span class='hs-comment'>--</span>
<a name="line-8"></a><span class='hs-comment'>-- Maintainer  :  Niklas Broberg, d00nibro@chalmers.se</span>
<a name="line-9"></a><span class='hs-comment'>-- Stability   :  experimental</span>
<a name="line-10"></a><span class='hs-comment'>-- Portability :  portable</span>
<a name="line-11"></a><span class='hs-comment'>--</span>
<a name="line-12"></a><span class='hs-comment'>-- This module contains combinators to use when building</span>
<a name="line-13"></a><span class='hs-comment'>-- Haskell source trees programmatically, as opposed to</span>
<a name="line-14"></a><span class='hs-comment'>-- parsing them from a string. The contents here are quite</span>
<a name="line-15"></a><span class='hs-comment'>-- experimental and will likely receive a lot of attention</span>
<a name="line-16"></a><span class='hs-comment'>-- when the rest has stabilised.</span>
<a name="line-17"></a><span class='hs-comment'>--</span>
<a name="line-18"></a><span class='hs-comment'>-----------------------------------------------------------------------------</span>
<a name="line-19"></a>
<a name="line-20"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>Language</span><span class='hs-varop'>.</span><span class='hs-conid'>Haskell</span><span class='hs-varop'>.</span><span class='hs-conid'>Exts</span><span class='hs-varop'>.</span><span class='hs-conid'>Annotated</span><span class='hs-varop'>.</span><span class='hs-conid'>Build</span> <span class='hs-layout'>(</span>
<a name="line-21"></a>
<a name="line-22"></a>    <span class='hs-comment'>-- * Syntax building functions</span>
<a name="line-23"></a>    <span class='hs-varid'>name</span><span class='hs-layout'>,</span>       <span class='hs-comment'>-- :: String -&gt; Name</span>
<a name="line-24"></a>    <span class='hs-varid'>sym</span><span class='hs-layout'>,</span>        <span class='hs-comment'>-- :: String -&gt; Name</span>
<a name="line-25"></a>    <span class='hs-varid'>var</span><span class='hs-layout'>,</span>        <span class='hs-comment'>-- :: Name -&gt; Exp</span>
<a name="line-26"></a>    <span class='hs-varid'>op</span><span class='hs-layout'>,</span>         <span class='hs-comment'>-- :: Name -&gt; QOp</span>
<a name="line-27"></a>    <span class='hs-varid'>qvar</span><span class='hs-layout'>,</span>       <span class='hs-comment'>-- :: Module -&gt; Name -&gt; Exp</span>
<a name="line-28"></a>    <span class='hs-varid'>pvar</span><span class='hs-layout'>,</span>       <span class='hs-comment'>-- :: Name -&gt; Pat</span>
<a name="line-29"></a>    <span class='hs-varid'>app</span><span class='hs-layout'>,</span>        <span class='hs-comment'>-- :: Exp -&gt; Exp -&gt; Exp</span>
<a name="line-30"></a>    <span class='hs-varid'>infixApp</span><span class='hs-layout'>,</span>   <span class='hs-comment'>-- :: Exp -&gt; QOp -&gt; Exp -&gt; Exp</span>
<a name="line-31"></a>    <span class='hs-varid'>appFun</span><span class='hs-layout'>,</span>     <span class='hs-comment'>-- :: Exp -&gt; [Exp] -&gt; Exp</span>
<a name="line-32"></a>    <span class='hs-varid'>pApp</span><span class='hs-layout'>,</span>       <span class='hs-comment'>-- :: Name -&gt; [Pat] -&gt; Pat</span>
<a name="line-33"></a>    <span class='hs-varid'>tuple</span><span class='hs-layout'>,</span>      <span class='hs-comment'>-- :: [Exp] -&gt; Exp</span>
<a name="line-34"></a>    <span class='hs-varid'>pTuple</span><span class='hs-layout'>,</span>     <span class='hs-comment'>-- :: [Pat] -&gt; Pat</span>
<a name="line-35"></a>    <span class='hs-varid'>varTuple</span><span class='hs-layout'>,</span>   <span class='hs-comment'>-- :: [Name] -&gt; Exp</span>
<a name="line-36"></a>    <span class='hs-varid'>pvarTuple</span><span class='hs-layout'>,</span>  <span class='hs-comment'>-- :: [Name] -&gt; Pat</span>
<a name="line-37"></a>    <span class='hs-varid'>function</span><span class='hs-layout'>,</span>   <span class='hs-comment'>-- :: String -&gt; Exp</span>
<a name="line-38"></a>    <span class='hs-varid'>strE</span><span class='hs-layout'>,</span>       <span class='hs-comment'>-- :: String -&gt; Exp</span>
<a name="line-39"></a>    <span class='hs-varid'>charE</span><span class='hs-layout'>,</span>      <span class='hs-comment'>-- :: Char -&gt; Exp</span>
<a name="line-40"></a>    <span class='hs-varid'>intE</span><span class='hs-layout'>,</span>       <span class='hs-comment'>-- :: Integer -&gt; Exp</span>
<a name="line-41"></a>    <span class='hs-varid'>strP</span><span class='hs-layout'>,</span>       <span class='hs-comment'>-- :: String -&gt; Pat</span>
<a name="line-42"></a>    <span class='hs-varid'>charP</span><span class='hs-layout'>,</span>      <span class='hs-comment'>-- :: Char -&gt; Pat</span>
<a name="line-43"></a>    <span class='hs-varid'>intP</span><span class='hs-layout'>,</span>       <span class='hs-comment'>-- :: Integer -&gt; Pat</span>
<a name="line-44"></a>    <span class='hs-varid'>doE</span><span class='hs-layout'>,</span>        <span class='hs-comment'>-- :: [Stmt] -&gt; Exp</span>
<a name="line-45"></a>    <span class='hs-varid'>lamE</span><span class='hs-layout'>,</span>       <span class='hs-comment'>-- :: SrcLoc -&gt; [Pat] -&gt; Exp -&gt; Exp</span>
<a name="line-46"></a>    <span class='hs-varid'>letE</span><span class='hs-layout'>,</span>       <span class='hs-comment'>-- :: [Decl] -&gt; Exp -&gt; Exp</span>
<a name="line-47"></a>    <span class='hs-varid'>caseE</span><span class='hs-layout'>,</span>      <span class='hs-comment'>-- :: Exp -&gt; [Alt] -&gt; Exp</span>
<a name="line-48"></a>    <span class='hs-varid'>alt</span><span class='hs-layout'>,</span>        <span class='hs-comment'>-- :: SrcLoc -&gt; Pat -&gt; Exp -&gt; Alt</span>
<a name="line-49"></a>    <span class='hs-varid'>altGW</span><span class='hs-layout'>,</span>      <span class='hs-comment'>-- :: SrcLoc -&gt; Pat -&gt; [Stmt] -&gt; Exp -&gt; Binds -&gt; Alt</span>
<a name="line-50"></a>    <span class='hs-varid'>listE</span><span class='hs-layout'>,</span>      <span class='hs-comment'>-- :: [Exp] -&gt; Exp</span>
<a name="line-51"></a>    <span class='hs-varid'>eList</span><span class='hs-layout'>,</span>      <span class='hs-comment'>-- :: Exp</span>
<a name="line-52"></a>    <span class='hs-varid'>peList</span><span class='hs-layout'>,</span>     <span class='hs-comment'>-- :: Pat</span>
<a name="line-53"></a>    <span class='hs-varid'>paren</span><span class='hs-layout'>,</span>      <span class='hs-comment'>-- :: Exp -&gt; Exp</span>
<a name="line-54"></a>    <span class='hs-varid'>pParen</span><span class='hs-layout'>,</span>     <span class='hs-comment'>-- :: Pat -&gt; Pat</span>
<a name="line-55"></a>    <span class='hs-varid'>qualStmt</span><span class='hs-layout'>,</span>   <span class='hs-comment'>-- :: Exp -&gt; Stmt</span>
<a name="line-56"></a>    <span class='hs-varid'>genStmt</span><span class='hs-layout'>,</span>    <span class='hs-comment'>-- :: SrcLoc -&gt; Pat -&gt; Exp -&gt; Stmt</span>
<a name="line-57"></a>    <span class='hs-varid'>letStmt</span><span class='hs-layout'>,</span>    <span class='hs-comment'>-- :: [Decl] -&gt; Stmt</span>
<a name="line-58"></a>    <span class='hs-varid'>binds</span><span class='hs-layout'>,</span>      <span class='hs-comment'>-- :: [Decl] -&gt; Binds</span>
<a name="line-59"></a>    <span class='hs-varid'>noBinds</span><span class='hs-layout'>,</span>    <span class='hs-comment'>-- :: Binds</span>
<a name="line-60"></a>    <span class='hs-varid'>wildcard</span><span class='hs-layout'>,</span>   <span class='hs-comment'>-- :: Pat</span>
<a name="line-61"></a>    <span class='hs-varid'>genNames</span><span class='hs-layout'>,</span>   <span class='hs-comment'>-- :: String -&gt; Int -&gt; [Name]</span>
<a name="line-62"></a>
<a name="line-63"></a>    <span class='hs-comment'>-- * More advanced building</span>
<a name="line-64"></a>    <span class='hs-varid'>sfun</span><span class='hs-layout'>,</span>           <span class='hs-comment'>-- :: SrcLoc -&gt; Name -&gt; [Name] -&gt; Rhs -&gt; Binds -&gt; Decl</span>
<a name="line-65"></a>    <span class='hs-varid'>simpleFun</span><span class='hs-layout'>,</span>      <span class='hs-comment'>-- :: SrcLoc -&gt; Name -&gt; Name -&gt; Exp -&gt; Decl</span>
<a name="line-66"></a>    <span class='hs-varid'>patBind</span><span class='hs-layout'>,</span>        <span class='hs-comment'>-- :: SrcLoc -&gt; Pat -&gt; Exp -&gt; Decl</span>
<a name="line-67"></a>    <span class='hs-varid'>patBindWhere</span><span class='hs-layout'>,</span>   <span class='hs-comment'>-- :: SrcLoc -&gt; Pat -&gt; Exp -&gt; [Decl] -&gt; Decl</span>
<a name="line-68"></a>    <span class='hs-varid'>nameBind</span><span class='hs-layout'>,</span>       <span class='hs-comment'>-- :: SrcLoc -&gt; Name -&gt; Exp -&gt; Decl</span>
<a name="line-69"></a>    <span class='hs-varid'>metaFunction</span><span class='hs-layout'>,</span>   <span class='hs-comment'>-- :: String -&gt; [Exp] -&gt; Exp</span>
<a name="line-70"></a>    <span class='hs-varid'>metaConPat</span>      <span class='hs-comment'>-- :: String -&gt; [Pat] -&gt; Pat</span>
<a name="line-71"></a>  <span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-72"></a>
<a name="line-73"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Language</span><span class='hs-varop'>.</span><span class='hs-conid'>Haskell</span><span class='hs-varop'>.</span><span class='hs-conid'>Exts</span><span class='hs-varop'>.</span><span class='hs-conid'>Annotated</span><span class='hs-varop'>.</span><span class='hs-conid'>Syntax</span>
<a name="line-74"></a>
<a name="line-75"></a><span class='hs-comment'>-----------------------------------------------------------------------------</span>
<a name="line-76"></a><span class='hs-comment'>-- Help functions for Abstract syntax</span>
<a name="line-77"></a>
<a name="line-78"></a><a name="name"></a><span class='hs-comment'>-- | An identifier with the given string as its name.</span>
<a name="line-79"></a><span class='hs-comment'>--   The string should be a valid Haskell identifier.</span>
<a name="line-80"></a><span class='hs-definition'>name</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Name</span> <span class='hs-varid'>l</span>
<a name="line-81"></a><span class='hs-definition'>name</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Ident</span>
<a name="line-82"></a>
<a name="line-83"></a><a name="sym"></a><span class='hs-comment'>-- | A symbol identifier. The string should be a valid</span>
<a name="line-84"></a><span class='hs-comment'>--   Haskell symbol identifier.</span>
<a name="line-85"></a><span class='hs-definition'>sym</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Name</span> <span class='hs-varid'>l</span>
<a name="line-86"></a><span class='hs-definition'>sym</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Symbol</span>
<a name="line-87"></a>
<a name="line-88"></a><a name="var"></a><span class='hs-comment'>-- | A local variable as expression.</span>
<a name="line-89"></a><span class='hs-definition'>var</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Name</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span>
<a name="line-90"></a><span class='hs-definition'>var</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Var</span> <span class='hs-varid'>l</span> <span class='hs-varop'>.</span> <span class='hs-conid'>UnQual</span> <span class='hs-varid'>l</span>
<a name="line-91"></a>
<a name="line-92"></a><a name="op"></a><span class='hs-comment'>-- | Use the given identifier as an operator.</span>
<a name="line-93"></a><span class='hs-definition'>op</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Name</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>QOp</span> <span class='hs-varid'>l</span>
<a name="line-94"></a><span class='hs-definition'>op</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>QVarOp</span> <span class='hs-varid'>l</span> <span class='hs-varop'>.</span> <span class='hs-conid'>UnQual</span> <span class='hs-varid'>l</span>
<a name="line-95"></a>
<a name="line-96"></a><a name="qvar"></a><span class='hs-comment'>-- | A qualified variable as expression.</span>
<a name="line-97"></a><span class='hs-definition'>qvar</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ModuleName</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Name</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span>
<a name="line-98"></a><span class='hs-definition'>qvar</span> <span class='hs-varid'>l</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Var</span> <span class='hs-varid'>l</span> <span class='hs-varop'>.</span> <span class='hs-conid'>Qual</span> <span class='hs-varid'>l</span> <span class='hs-varid'>m</span>
<a name="line-99"></a>
<a name="line-100"></a><a name="pvar"></a><span class='hs-comment'>-- | A pattern variable.</span>
<a name="line-101"></a><span class='hs-definition'>pvar</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Name</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pat</span> <span class='hs-varid'>l</span>
<a name="line-102"></a><span class='hs-definition'>pvar</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PVar</span>
<a name="line-103"></a>
<a name="line-104"></a><a name="app"></a><span class='hs-comment'>-- | Application of expressions by juxtaposition.</span>
<a name="line-105"></a><span class='hs-definition'>app</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span>
<a name="line-106"></a><span class='hs-definition'>app</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>App</span>
<a name="line-107"></a>
<a name="line-108"></a><a name="infixApp"></a><span class='hs-comment'>-- | Apply an operator infix.</span>
<a name="line-109"></a><span class='hs-definition'>infixApp</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>QOp</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span>
<a name="line-110"></a><span class='hs-definition'>infixApp</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>InfixApp</span>
<a name="line-111"></a>
<a name="line-112"></a><a name="appFun"></a><span class='hs-comment'>-- | Apply a function to a list of arguments.</span>
<a name="line-113"></a><span class='hs-definition'>appFun</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>l</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span>
<a name="line-114"></a><span class='hs-definition'>appFun</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>f</span> <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span>
<a name="line-115"></a><span class='hs-definition'>appFun</span> <span class='hs-layout'>(</span><span class='hs-varid'>l</span><span class='hs-conop'>:</span><span class='hs-varid'>ls</span><span class='hs-layout'>)</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-conop'>:</span><span class='hs-keyword'>as</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>appFun</span> <span class='hs-varid'>ls</span> <span class='hs-layout'>(</span><span class='hs-varid'>app</span> <span class='hs-varid'>l</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>as</span>
<a name="line-116"></a>
<a name="line-117"></a><a name="pApp"></a><span class='hs-comment'>-- | A constructor pattern, with argument patterns.</span>
<a name="line-118"></a><span class='hs-definition'>pApp</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Name</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Pat</span> <span class='hs-varid'>l</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pat</span> <span class='hs-varid'>l</span>
<a name="line-119"></a><span class='hs-definition'>pApp</span> <span class='hs-varid'>l</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PApp</span> <span class='hs-varid'>l</span> <span class='hs-layout'>(</span><span class='hs-conid'>UnQual</span> <span class='hs-varid'>l</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>
<a name="line-120"></a>
<a name="line-121"></a><a name="tuple"></a><span class='hs-comment'>-- | A tuple expression.</span>
<a name="line-122"></a><span class='hs-definition'>tuple</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span>
<a name="line-123"></a><span class='hs-definition'>tuple</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Tuple</span> <span class='hs-varid'>l</span> <span class='hs-conid'>Boxed</span>
<a name="line-124"></a>
<a name="line-125"></a><a name="pTuple"></a><span class='hs-comment'>-- | A tuple pattern.</span>
<a name="line-126"></a><span class='hs-definition'>pTuple</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Pat</span> <span class='hs-varid'>l</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pat</span> <span class='hs-varid'>l</span>
<a name="line-127"></a><span class='hs-definition'>pTuple</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PTuple</span> <span class='hs-varid'>l</span> <span class='hs-conid'>Boxed</span>
<a name="line-128"></a>
<a name="line-129"></a><a name="varTuple"></a><span class='hs-comment'>-- | A tuple expression consisting of variables only.</span>
<a name="line-130"></a><span class='hs-definition'>varTuple</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Name</span> <span class='hs-varid'>l</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span>
<a name="line-131"></a><span class='hs-definition'>varTuple</span> <span class='hs-varid'>l</span> <span class='hs-varid'>ns</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tuple</span> <span class='hs-varid'>l</span> <span class='hs-varop'>$</span> <span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-varid'>var</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-varid'>ns</span>
<a name="line-132"></a>
<a name="line-133"></a><a name="pvarTuple"></a><span class='hs-comment'>-- | A tuple pattern consisting of variables only.</span>
<a name="line-134"></a><span class='hs-definition'>pvarTuple</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Name</span> <span class='hs-varid'>l</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pat</span> <span class='hs-varid'>l</span>
<a name="line-135"></a><span class='hs-definition'>pvarTuple</span> <span class='hs-varid'>l</span> <span class='hs-varid'>ns</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pTuple</span> <span class='hs-varid'>l</span> <span class='hs-varop'>$</span> <span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-varid'>pvar</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-varid'>ns</span>
<a name="line-136"></a>
<a name="line-137"></a><a name="function"></a><span class='hs-comment'>-- | A function with a given name.</span>
<a name="line-138"></a><span class='hs-definition'>function</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span>
<a name="line-139"></a><span class='hs-definition'>function</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>var</span> <span class='hs-varid'>l</span> <span class='hs-varop'>.</span> <span class='hs-conid'>Ident</span> <span class='hs-varid'>l</span>
<a name="line-140"></a>
<a name="line-141"></a><a name="strE"></a><span class='hs-comment'>-- | A literal string expression.</span>
<a name="line-142"></a><span class='hs-definition'>strE</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span>
<a name="line-143"></a><span class='hs-definition'>strE</span> <span class='hs-varid'>l</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Lit</span> <span class='hs-varid'>l</span> <span class='hs-varop'>$</span> <span class='hs-conid'>String</span> <span class='hs-varid'>l</span> <span class='hs-varid'>s</span> <span class='hs-varid'>s</span>
<a name="line-144"></a>
<a name="line-145"></a><a name="charE"></a><span class='hs-comment'>-- | A literal character expression.</span>
<a name="line-146"></a><span class='hs-definition'>charE</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Char</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span>
<a name="line-147"></a><span class='hs-definition'>charE</span> <span class='hs-varid'>l</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Lit</span> <span class='hs-varid'>l</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Char</span> <span class='hs-varid'>l</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>c</span><span class='hs-keyglyph'>]</span>
<a name="line-148"></a>
<a name="line-149"></a><a name="intE"></a><span class='hs-comment'>-- | A literal integer expression.</span>
<a name="line-150"></a><span class='hs-definition'>intE</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span>
<a name="line-151"></a><span class='hs-definition'>intE</span> <span class='hs-varid'>l</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Lit</span> <span class='hs-varid'>l</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Int</span> <span class='hs-varid'>l</span> <span class='hs-varid'>i</span> <span class='hs-layout'>(</span><span class='hs-varid'>show</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>
<a name="line-152"></a>
<a name="line-153"></a><a name="strP"></a><span class='hs-comment'>-- | A literal string pattern.</span>
<a name="line-154"></a><span class='hs-definition'>strP</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pat</span> <span class='hs-varid'>l</span>
<a name="line-155"></a><span class='hs-definition'>strP</span> <span class='hs-varid'>l</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PLit</span> <span class='hs-varid'>l</span> <span class='hs-varop'>$</span> <span class='hs-conid'>String</span> <span class='hs-varid'>l</span> <span class='hs-varid'>s</span> <span class='hs-varid'>s</span>
<a name="line-156"></a>
<a name="line-157"></a><a name="charP"></a><span class='hs-comment'>-- | A literal character pattern.</span>
<a name="line-158"></a><span class='hs-definition'>charP</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Char</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pat</span> <span class='hs-varid'>l</span>
<a name="line-159"></a><span class='hs-definition'>charP</span> <span class='hs-varid'>l</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PLit</span> <span class='hs-varid'>l</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Char</span> <span class='hs-varid'>l</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>c</span><span class='hs-keyglyph'>]</span>
<a name="line-160"></a>
<a name="line-161"></a><a name="intP"></a><span class='hs-comment'>-- | A literal integer pattern.</span>
<a name="line-162"></a><span class='hs-definition'>intP</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pat</span> <span class='hs-varid'>l</span>
<a name="line-163"></a><span class='hs-definition'>intP</span> <span class='hs-varid'>l</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PLit</span> <span class='hs-varid'>l</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Int</span> <span class='hs-varid'>l</span> <span class='hs-varid'>i</span> <span class='hs-layout'>(</span><span class='hs-varid'>show</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>
<a name="line-164"></a>
<a name="line-165"></a><a name="doE"></a><span class='hs-comment'>-- | A do block formed by the given statements.</span>
<a name="line-166"></a><span class='hs-comment'>--   The last statement in the list should be</span>
<a name="line-167"></a><span class='hs-comment'>--   a 'Qualifier' expression.</span>
<a name="line-168"></a><span class='hs-definition'>doE</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Stmt</span> <span class='hs-varid'>l</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span>
<a name="line-169"></a><span class='hs-definition'>doE</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Do</span>
<a name="line-170"></a>
<a name="line-171"></a><a name="lamE"></a><span class='hs-comment'>-- | Lambda abstraction, given a list of argument</span>
<a name="line-172"></a><span class='hs-comment'>--   patterns and an expression body.</span>
<a name="line-173"></a><span class='hs-definition'>lamE</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Pat</span> <span class='hs-varid'>l</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span>
<a name="line-174"></a><span class='hs-definition'>lamE</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Lambda</span>
<a name="line-175"></a>
<a name="line-176"></a><a name="letE"></a><span class='hs-comment'>-- | A @let@ ... @in@ block.</span>
<a name="line-177"></a><span class='hs-definition'>letE</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Decl</span> <span class='hs-varid'>l</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span>
<a name="line-178"></a><span class='hs-definition'>letE</span> <span class='hs-varid'>l</span> <span class='hs-varid'>ds</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Let</span> <span class='hs-varid'>l</span> <span class='hs-layout'>(</span><span class='hs-varid'>binds</span> <span class='hs-varid'>l</span> <span class='hs-varid'>ds</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span>
<a name="line-179"></a>
<a name="line-180"></a><a name="caseE"></a><span class='hs-comment'>-- | A @case@ expression.</span>
<a name="line-181"></a><span class='hs-definition'>caseE</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Alt</span> <span class='hs-varid'>l</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span>
<a name="line-182"></a><span class='hs-definition'>caseE</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Case</span>
<a name="line-183"></a>
<a name="line-184"></a><a name="alt"></a><span class='hs-comment'>-- | An unguarded alternative in a @case@ expression.</span>
<a name="line-185"></a><span class='hs-definition'>alt</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pat</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Alt</span> <span class='hs-varid'>l</span>
<a name="line-186"></a><span class='hs-definition'>alt</span> <span class='hs-varid'>l</span> <span class='hs-varid'>p</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Alt</span> <span class='hs-varid'>l</span> <span class='hs-varid'>p</span> <span class='hs-layout'>(</span><span class='hs-varid'>unGAlt</span> <span class='hs-varid'>l</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-conid'>Nothing</span>
<a name="line-187"></a>
<a name="line-188"></a><a name="altGW"></a><span class='hs-comment'>-- | An alternative with a single guard in a @case@ expression.</span>
<a name="line-189"></a><span class='hs-definition'>altGW</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pat</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Stmt</span> <span class='hs-varid'>l</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Binds</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Alt</span> <span class='hs-varid'>l</span>
<a name="line-190"></a><span class='hs-definition'>altGW</span> <span class='hs-varid'>l</span> <span class='hs-varid'>p</span> <span class='hs-varid'>gs</span> <span class='hs-varid'>e</span> <span class='hs-varid'>w</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Alt</span> <span class='hs-varid'>l</span> <span class='hs-varid'>p</span> <span class='hs-layout'>(</span><span class='hs-varid'>gAlt</span> <span class='hs-varid'>l</span> <span class='hs-varid'>gs</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span>
<a name="line-191"></a>
<a name="line-192"></a><a name="unGAlt"></a><span class='hs-comment'>-- | An unguarded righthand side of a @case@ alternative.</span>
<a name="line-193"></a><span class='hs-definition'>unGAlt</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GuardedAlts</span> <span class='hs-varid'>l</span>
<a name="line-194"></a><span class='hs-definition'>unGAlt</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>UnGuardedAlt</span>
<a name="line-195"></a>
<a name="line-196"></a><a name="gAlts"></a><span class='hs-comment'>-- | An list of guarded righthand sides for a @case@ alternative.</span>
<a name="line-197"></a><span class='hs-definition'>gAlts</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>[</span><span class='hs-conid'>Stmt</span> <span class='hs-varid'>l</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GuardedAlts</span> <span class='hs-varid'>l</span>
<a name="line-198"></a><span class='hs-definition'>gAlts</span> <span class='hs-varid'>l</span> <span class='hs-keyword'>as</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>GuardedAlts</span> <span class='hs-varid'>l</span> <span class='hs-varop'>$</span> <span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-layout'>(</span><span class='hs-varid'>gs</span><span class='hs-layout'>,</span><span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GuardedAlt</span> <span class='hs-varid'>l</span> <span class='hs-varid'>gs</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-keyword'>as</span>
<a name="line-199"></a>
<a name="line-200"></a><a name="gAlt"></a><span class='hs-comment'>-- | A single guarded righthand side for a @case@ alternative.</span>
<a name="line-201"></a><span class='hs-definition'>gAlt</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Stmt</span> <span class='hs-varid'>l</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GuardedAlts</span> <span class='hs-varid'>l</span>
<a name="line-202"></a><span class='hs-definition'>gAlt</span> <span class='hs-varid'>l</span> <span class='hs-varid'>gs</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>gAlts</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-varid'>gs</span><span class='hs-layout'>,</span><span class='hs-varid'>e</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-203"></a>
<a name="line-204"></a><a name="listE"></a><span class='hs-comment'>-- | A list expression.</span>
<a name="line-205"></a><span class='hs-definition'>listE</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span>
<a name="line-206"></a><span class='hs-definition'>listE</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>List</span>
<a name="line-207"></a>
<a name="line-208"></a><a name="eList"></a><span class='hs-comment'>-- | The empty list expression.</span>
<a name="line-209"></a><span class='hs-definition'>eList</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span>
<a name="line-210"></a><span class='hs-definition'>eList</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>List</span> <span class='hs-varid'>l</span> <span class='hs-conid'>[]</span>
<a name="line-211"></a>
<a name="line-212"></a><a name="peList"></a><span class='hs-comment'>-- | The empty list pattern.</span>
<a name="line-213"></a><span class='hs-definition'>peList</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pat</span> <span class='hs-varid'>l</span>
<a name="line-214"></a><span class='hs-definition'>peList</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PList</span> <span class='hs-varid'>l</span> <span class='hs-conid'>[]</span>
<a name="line-215"></a>
<a name="line-216"></a><a name="paren"></a><span class='hs-comment'>-- | Put parentheses around an expression.</span>
<a name="line-217"></a><span class='hs-definition'>paren</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span>
<a name="line-218"></a><span class='hs-definition'>paren</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Paren</span>
<a name="line-219"></a>
<a name="line-220"></a><a name="pParen"></a><span class='hs-comment'>-- | Put parentheses around a pattern.</span>
<a name="line-221"></a><span class='hs-definition'>pParen</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pat</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pat</span> <span class='hs-varid'>l</span>
<a name="line-222"></a><span class='hs-definition'>pParen</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PParen</span>
<a name="line-223"></a>
<a name="line-224"></a><a name="qualStmt"></a><span class='hs-comment'>-- | A qualifier expression statement.</span>
<a name="line-225"></a><span class='hs-definition'>qualStmt</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Stmt</span> <span class='hs-varid'>l</span>
<a name="line-226"></a><span class='hs-definition'>qualStmt</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Qualifier</span>
<a name="line-227"></a>
<a name="line-228"></a><a name="genStmt"></a><span class='hs-comment'>-- | A generator statement: /pat/ @&lt;-@ /exp/</span>
<a name="line-229"></a><span class='hs-definition'>genStmt</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pat</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Stmt</span> <span class='hs-varid'>l</span>
<a name="line-230"></a><span class='hs-definition'>genStmt</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Generator</span>
<a name="line-231"></a>
<a name="line-232"></a><a name="letStmt"></a><span class='hs-comment'>-- | A @let@ binding group as a statement.</span>
<a name="line-233"></a><span class='hs-definition'>letStmt</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Decl</span> <span class='hs-varid'>l</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Stmt</span> <span class='hs-varid'>l</span>
<a name="line-234"></a><span class='hs-definition'>letStmt</span> <span class='hs-varid'>l</span> <span class='hs-varid'>ds</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>LetStmt</span> <span class='hs-varid'>l</span> <span class='hs-varop'>$</span> <span class='hs-varid'>binds</span> <span class='hs-varid'>l</span> <span class='hs-varid'>ds</span>
<a name="line-235"></a>
<a name="line-236"></a><a name="binds"></a><span class='hs-comment'>-- | Hoist a set of declarations to a binding group.</span>
<a name="line-237"></a><span class='hs-definition'>binds</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Decl</span> <span class='hs-varid'>l</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Binds</span> <span class='hs-varid'>l</span>
<a name="line-238"></a><span class='hs-definition'>binds</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BDecls</span>
<a name="line-239"></a>
<a name="line-240"></a><a name="noBinds"></a><span class='hs-comment'>-- | An empty binding group.</span>
<a name="line-241"></a><span class='hs-definition'>noBinds</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Binds</span> <span class='hs-varid'>l</span>
<a name="line-242"></a><span class='hs-definition'>noBinds</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>binds</span> <span class='hs-varid'>l</span> <span class='hs-conid'>[]</span>
<a name="line-243"></a>
<a name="line-244"></a><a name="wildcard"></a><span class='hs-comment'>-- | The wildcard pattern: @_@</span>
<a name="line-245"></a><span class='hs-definition'>wildcard</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pat</span> <span class='hs-varid'>l</span>
<a name="line-246"></a><span class='hs-definition'>wildcard</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PWildCard</span>
<a name="line-247"></a>
<a name="line-248"></a><a name="genNames"></a><span class='hs-comment'>-- | Generate k names by appending numbers 1 through k to a given string.</span>
<a name="line-249"></a><span class='hs-definition'>genNames</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Name</span> <span class='hs-varid'>l</span><span class='hs-keyglyph'>]</span>
<a name="line-250"></a><span class='hs-definition'>genNames</span> <span class='hs-varid'>l</span> <span class='hs-varid'>s</span> <span class='hs-varid'>k</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span> <span class='hs-conid'>Ident</span> <span class='hs-varid'>l</span> <span class='hs-varop'>$</span> <span class='hs-varid'>s</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-keyglyph'>[</span><span class='hs-num'>1</span><span class='hs-keyglyph'>..</span><span class='hs-varid'>k</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>]</span>
<a name="line-251"></a>
<a name="line-252"></a><span class='hs-comment'>-------------------------------------------------------------------------------</span>
<a name="line-253"></a><span class='hs-comment'>-- Some more specialised help functions</span>
<a name="line-254"></a>
<a name="line-255"></a><a name="sfun"></a><span class='hs-comment'>-- | A function with a single clause</span>
<a name="line-256"></a><span class='hs-definition'>sfun</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Name</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Name</span> <span class='hs-varid'>l</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Rhs</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>Binds</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Decl</span> <span class='hs-varid'>l</span>
<a name="line-257"></a><span class='hs-definition'>sfun</span> <span class='hs-varid'>l</span> <span class='hs-varid'>f</span> <span class='hs-varid'>pvs</span> <span class='hs-varid'>rhs</span> <span class='hs-varid'>mbs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>FunBind</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Match</span> <span class='hs-varid'>l</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-varid'>pvar</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-varid'>pvs</span><span class='hs-layout'>)</span> <span class='hs-varid'>rhs</span> <span class='hs-varid'>mbs</span><span class='hs-keyglyph'>]</span>
<a name="line-258"></a>
<a name="line-259"></a><a name="simpleFun"></a><span class='hs-comment'>-- | A function with a single clause, a single argument, no guards</span>
<a name="line-260"></a><span class='hs-comment'>-- and no where declarations</span>
<a name="line-261"></a><span class='hs-definition'>simpleFun</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Name</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Name</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Decl</span> <span class='hs-varid'>l</span>
<a name="line-262"></a><span class='hs-definition'>simpleFun</span> <span class='hs-varid'>l</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-varid'>rhs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>UnGuardedRhs</span> <span class='hs-varid'>l</span> <span class='hs-varid'>e</span>
<a name="line-263"></a>             <span class='hs-keyword'>in</span> <span class='hs-varid'>sfun</span> <span class='hs-varid'>l</span> <span class='hs-varid'>f</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-varid'>rhs</span> <span class='hs-conid'>Nothing</span>
<a name="line-264"></a>
<a name="line-265"></a><a name="patBind"></a><span class='hs-comment'>-- | A pattern bind where the pattern is a variable, and where</span>
<a name="line-266"></a><span class='hs-comment'>-- there are no guards and no 'where' clause.</span>
<a name="line-267"></a><span class='hs-definition'>patBind</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pat</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Decl</span> <span class='hs-varid'>l</span>
<a name="line-268"></a><span class='hs-definition'>patBind</span> <span class='hs-varid'>l</span> <span class='hs-varid'>p</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-varid'>rhs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>UnGuardedRhs</span> <span class='hs-varid'>l</span> <span class='hs-varid'>e</span>
<a name="line-269"></a>         <span class='hs-keyword'>in</span> <span class='hs-conid'>PatBind</span> <span class='hs-varid'>l</span> <span class='hs-varid'>p</span> <span class='hs-conid'>Nothing</span> <span class='hs-varid'>rhs</span> <span class='hs-conid'>Nothing</span>
<a name="line-270"></a>
<a name="line-271"></a><a name="patBindWhere"></a><span class='hs-comment'>-- | A pattern bind where the pattern is a variable, and where</span>
<a name="line-272"></a><span class='hs-comment'>-- there are no guards, but with a 'where' clause.</span>
<a name="line-273"></a><span class='hs-definition'>patBindWhere</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pat</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Decl</span> <span class='hs-varid'>l</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Decl</span> <span class='hs-varid'>l</span>
<a name="line-274"></a><span class='hs-definition'>patBindWhere</span> <span class='hs-varid'>l</span> <span class='hs-varid'>p</span> <span class='hs-varid'>e</span> <span class='hs-varid'>ds</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-varid'>rhs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>UnGuardedRhs</span> <span class='hs-varid'>l</span> <span class='hs-varid'>e</span>
<a name="line-275"></a>             <span class='hs-keyword'>in</span> <span class='hs-conid'>PatBind</span> <span class='hs-varid'>l</span> <span class='hs-varid'>p</span> <span class='hs-conid'>Nothing</span> <span class='hs-varid'>rhs</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-varop'>$</span> <span class='hs-varid'>binds</span> <span class='hs-varid'>l</span> <span class='hs-varid'>ds</span><span class='hs-layout'>)</span>
<a name="line-276"></a>
<a name="line-277"></a><a name="nameBind"></a><span class='hs-comment'>-- | Bind an identifier to an expression.</span>
<a name="line-278"></a><span class='hs-definition'>nameBind</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Name</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Decl</span> <span class='hs-varid'>l</span>
<a name="line-279"></a><span class='hs-definition'>nameBind</span> <span class='hs-varid'>l</span> <span class='hs-varid'>n</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>patBind</span> <span class='hs-varid'>l</span> <span class='hs-layout'>(</span><span class='hs-varid'>pvar</span> <span class='hs-varid'>l</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span>
<a name="line-280"></a>
<a name="line-281"></a><a name="metaFunction"></a><span class='hs-comment'>-- | Apply function of a given name to a list of arguments.</span>
<a name="line-282"></a><span class='hs-definition'>metaFunction</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Exp</span> <span class='hs-varid'>l</span>
<a name="line-283"></a><span class='hs-definition'>metaFunction</span> <span class='hs-varid'>l</span> <span class='hs-varid'>s</span> <span class='hs-varid'>es</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mf</span> <span class='hs-varid'>l</span> <span class='hs-varid'>s</span> <span class='hs-layout'>(</span><span class='hs-varid'>reverse</span> <span class='hs-varid'>es</span><span class='hs-layout'>)</span>
<a name="line-284"></a>  <span class='hs-keyword'>where</span> <span class='hs-varid'>mf</span> <span class='hs-varid'>l</span> <span class='hs-varid'>s</span> <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>var</span> <span class='hs-varid'>l</span> <span class='hs-varop'>$</span> <span class='hs-varid'>name</span> <span class='hs-varid'>l</span> <span class='hs-varid'>s</span>
<a name="line-285"></a>        <span class='hs-varid'>mf</span> <span class='hs-varid'>l</span> <span class='hs-varid'>s</span> <span class='hs-layout'>(</span><span class='hs-varid'>e</span><span class='hs-conop'>:</span><span class='hs-varid'>es</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>app</span> <span class='hs-varid'>l</span> <span class='hs-layout'>(</span><span class='hs-varid'>mf</span> <span class='hs-varid'>l</span> <span class='hs-varid'>s</span> <span class='hs-varid'>es</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span>
<a name="line-286"></a>
<a name="line-287"></a><a name="metaConPat"></a><span class='hs-comment'>-- | Apply a constructor of a given name to a list of pattern</span>
<a name="line-288"></a><span class='hs-comment'>--   arguments, forming a constructor pattern.</span>
<a name="line-289"></a><span class='hs-definition'>metaConPat</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Pat</span> <span class='hs-varid'>l</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pat</span> <span class='hs-varid'>l</span>
<a name="line-290"></a><span class='hs-definition'>metaConPat</span> <span class='hs-varid'>l</span> <span class='hs-varid'>s</span> <span class='hs-varid'>ps</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pApp</span> <span class='hs-varid'>l</span> <span class='hs-layout'>(</span><span class='hs-varid'>name</span> <span class='hs-varid'>l</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-varid'>ps</span>
</pre></body>
</html>
